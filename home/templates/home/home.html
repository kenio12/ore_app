{% extends 'base.html' %}
{% load static %}
{% load app_filters %}

{% block content %}
<!-- サイバーパンク風の背景 -->
<div class="cyber-background position-fixed w-100 h-100" style="top: 0; left: 0; z-index: -1;">
    <div class="cyber-grid"></div>
</div>

<div class="min-vh-100">
    <!-- タブナビゲーション -->
    <div class="container mt-2">
        <ul class="nav nav-tabs cyber-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active cyber-tab" id="apps-tab" data-bs-toggle="tab" data-bs-target="#apps-content" type="button" role="tab" aria-controls="apps-content" aria-selected="true">
                    <i class="bi bi-app"></i> 公開アプリ
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link cyber-tab" id="programmers-tab" data-bs-toggle="tab" data-bs-target="#programmers-content" type="button" role="tab" aria-controls="programmers-content" aria-selected="false">
                    <i class="bi bi-people"></i> プログラマー達
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link cyber-tab" id="blogs-tab" data-bs-toggle="tab" data-bs-target="#blogs-content" type="button" role="tab" aria-controls="blogs-content" aria-selected="false">
                    <i class="bi bi-journal-code"></i> 開発ブログ
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link cyber-tab" id="contest-tab" data-bs-toggle="tab" data-bs-target="#contest-content" type="button" role="tab" aria-controls="contest-content" aria-selected="false">
                    <i class="bi bi-trophy"></i> アプリ開発大会
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link cyber-tab" id="jobs-tab" data-bs-toggle="tab" data-bs-target="#jobs-content" type="button" role="tab" aria-controls="jobs-content" aria-selected="false">
                    <i class="bi bi-briefcase"></i> お仕事依頼
                </button>
            </li>
        </ul>
    </div>

    <!-- タブコンテンツ -->
    <div class="tab-content" id="mainTabsContent">
        <!-- 公開アプリタブ -->
        <div class="tab-pane fade show active" id="apps-content" role="tabpanel" aria-labelledby="apps-tab">
            {% include 'home/tabs/apps_tab.html' %}
        </div>

        <!-- プログラマー達タブ -->
        <div class="tab-pane fade" id="programmers-content" role="tabpanel" aria-labelledby="programmers-tab">
            {% include 'home/tabs/programmers_tab.html' %}
        </div>

        <!-- 開発ブログタブ -->
        <div class="tab-pane fade" id="blogs-content" role="tabpanel" aria-labelledby="blogs-tab">
            {% include 'home/tabs/blogs_tab.html' %}
        </div>

        <!-- アプリ開発大会タブ -->
        <div class="tab-pane fade" id="contest-content" role="tabpanel" aria-labelledby="contest-tab">
            {% include 'home/tabs/contest_tab.html' %}
        </div>

        <!-- お仕事依頼タブ -->
        <div class="tab-pane fade" id="jobs-content" role="tabpanel" aria-labelledby="jobs-tab">
            {% include 'home/tabs/jobs_tab.html' %}
        </div>
    </div>
</div>

<!-- JavaScriptの変数を定義して、アプリデータを保持 -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // アプリカード関連の処理
        const apps_data = [
            {% for app in apps %}
            {
                id: {{ app.id }},
                is_author: {% if request.user == app.author %}true{% else %}false{% endif %},
                detail_url: "{% url 'apps_gallery:detail' app.id %}",
                edit_url: "{% url 'apps_gallery:edit' app.id %}"
            }{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // 画像の向きを確認する関数
        function checkImageOrientation(img, appId) {
            const isPortrait = img.naturalHeight > img.naturalWidth;
            const card = document.getElementById('card-content-' + appId);
            
            if (isPortrait && card) {
                card.classList.add('is-portrait');
            }
        }
        
        // グローバルスコープに公開
        window.checkImageOrientation = checkImageOrientation;
    });
</script>

<!-- サイバーパンクスタイル -->
<style>
    /* 背景スタイル */
    .cyber-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #0c1423;  /* 暗めの青黒色 */
        z-index: -2;
    }

    .cyber-grid {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: 
            linear-gradient(rgba(33, 150, 243, 0.1) 1px, transparent 1px),
            linear-gradient(90deg, rgba(33, 150, 243, 0.1) 1px, transparent 1px);
        background-size: 50px 50px;
        z-index: -1;
        perspective: 1000px;
        transform-style: preserve-3d;
        animation: grid-fade 5s infinite linear;
    }

    @keyframes grid-fade {
        0% { opacity: 0.5; }
        50% { opacity: 0.7; }
        100% { opacity: 0.5; }
    }

    /* タブスタイル */
    .cyber-tabs {
        border-bottom: none !important;
    }

    .cyber-tab {
        background-color: rgba(0, 0, 0, 0.6) !important;
        color: #00bfff !important;
        border: 1px solid rgba(0, 191, 255, 0.3) !important;
        border-bottom: none !important;
        margin-right: 5px;
        border-top-left-radius: 10px !important;
        border-top-right-radius: 10px !important;
        transition: all 0.3s ease;
    }

    .cyber-tab:hover {
        background-color: rgba(0, 0, 0, 0.8) !important;
        color: #00ffff !important;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
    }

    .cyber-tab.active {
        background-color: rgba(0, 0, 0, 0.8) !important;
        color: #00ffff !important;
        border-color: rgba(0, 255, 255, 0.5) !important;
        font-weight: bold;
        box-shadow: 0 -5px 15px rgba(0, 255, 255, 0.3);
        border-bottom: none;
    }

    /* カードスタイル */
    .cyber-card {
        background-color: rgba(13, 25, 45, 0.95) !important;
        border: 1px solid rgba(0, 191, 255, 0.3) !important;
        border-radius: 10px !important;
        box-shadow: 0 0 20px rgba(0, 100, 200, 0.3) !important;
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .cyber-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 30px rgba(0, 200, 255, 0.4) !important;
        border: 1px solid rgba(0, 255, 255, 0.5) !important;
    }

    .cyber-image {
        border-top-left-radius: 10px;
        border-bottom-left-radius: 10px;
        transition: all 0.3s ease;
        overflow: hidden;
    }

    /* ポートレート画像の場合のスタイル */
    .is-portrait .cyber-image {
        max-height: 300px;
        width: auto;
        margin: 0 auto;
    }

    /* テキストスタイル */
    .cyber-title {
        color: #00bfff !important;
        text-shadow: 0 0 10px rgba(0, 191, 255, 0.5) !important;
        font-weight: bold !important;
        letter-spacing: 1px;
    }

    .cyber-description {
        color: #b8c8db !important;
        text-shadow: 0 0 5px rgba(184, 200, 219, 0.3) !important;
    }

    /* バッジスタイル */
    .cyber-type {
        background-color: rgba(255, 0, 128, 0.2) !important;
        color: #ff80c0 !important;
        border: 1px solid rgba(255, 0, 128, 0.5) !important;
        box-shadow: 0 0 10px rgba(255, 0, 128, 0.3) !important;
        font-weight: normal !important;
        text-shadow: none !important;
    }

    .cyber-genre {
        background-color: rgba(0, 128, 255, 0.2) !important;
        color: #80c0ff !important;
        border: 1px solid rgba(0, 128, 255, 0.5) !important;
        box-shadow: 0 0 10px rgba(0, 128, 255, 0.3) !important;
        font-weight: normal !important;
        text-shadow: none !important;
    }
    
    .cyber-backend-lang {
        background-color: rgba(128, 0, 255, 0.2) !important;
        color: #c080ff !important;
        border: 1px solid rgba(128, 0, 255, 0.5) !important;
        box-shadow: 0 0 10px rgba(128, 0, 255, 0.3) !important;
        font-weight: normal !important;
        text-shadow: none !important;
    }

    /* 空の状態のテキスト */
    .cyber-empty-text {
        color: #00ffff !important;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.5) !important;
        font-weight: bold !important;
    }

    .cyber-empty-subtext {
        color: #80c0c0 !important;
        text-shadow: 0 0 5px rgba(128, 192, 192, 0.3) !important;
    }

    /* ボタンスタイル */
    .btn-cyber-secondary {
        background: rgba(0, 0, 0, 0.6) !important;
        color: #00bfff !important;
        border: 1px solid rgba(0, 191, 255, 0.5) !important;
        transition: all 0.3s ease !important;
    }

    .btn-cyber-secondary:hover {
        background: rgba(0, 0, 0, 0.8) !important;
        color: #00ffff !important;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5) !important;
        transform: translateY(-2px) !important;
    }

    .btn-cyber-edit {
        background: rgba(0, 0, 0, 0.6) !important;
        color: #ff80c0 !important;
        border: 1px solid rgba(255, 0, 128, 0.5) !important;
        transition: all 0.3s ease !important;
    }

    .btn-cyber-edit:hover {
        background: rgba(0, 0, 0, 0.8) !important;
        color: #ff00ff !important;
        box-shadow: 0 0 15px rgba(255, 0, 255, 0.5) !important;
        transform: translateY(-2px) !important;
    }
    
    /* フォーム要素の共通サイバースタイル */
    .form-control.cyber-input {
        background-color: rgba(0, 10, 20, 0.8) !important;
        border: 1px solid rgba(0, 191, 255, 0.3) !important;
        color: #00bfff !important;
        transition: all 0.3s ease;
    }
    
    .form-control.cyber-input:focus {
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5) !important;
        border-color: rgba(0, 255, 255, 0.5) !important;
        background-color: rgba(0, 20, 40, 0.8) !important;
    }
    
    .form-select.cyber-select {
        background-color: rgba(0, 10, 20, 0.8) !important;
        border: 1px solid rgba(0, 191, 255, 0.3) !important;
        color: #00bfff !important;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%2300bfff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e") !important;
    }
    
    .form-select.cyber-select:focus {
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5) !important;
        border-color: rgba(0, 255, 255, 0.5) !important;
        background-color: rgba(0, 20, 40, 0.8) !important;
    }
    
    /* プレースホルダーのサイバースタイル */
    .cyber-placeholder-content {
        padding: 3rem;
        text-align: center;
        border: 2px dashed rgba(0, 191, 255, 0.3);
        border-radius: 15px;
        background-color: rgba(0, 10, 20, 0.5);
    }
    
    .cyber-coming-soon {
        margin-top: 2rem;
    }
    
    .cyber-glitch-text {
        font-size: 2rem;
        font-weight: bold;
        color: #00ffff;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
        animation: glitch 2s infinite;
        position: relative;
        display: inline-block;
    }
    
    @keyframes glitch {
        0% {
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transform: translateX(0);
        }
        2% {
            text-shadow: 2px 0 10px rgba(255, 0, 128, 0.7), -2px 0 10px rgba(0, 255, 255, 0.7);
            transform: translateX(2px);
        }
        4% {
            text-shadow: -2px 0 10px rgba(255, 0, 128, 0.7), 2px 0 10px rgba(0, 255, 255, 0.7);
            transform: translateX(-2px);
        }
        6% {
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transform: translateX(0);
        }
        100% {
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transform: translateX(0);
        }
    }
    
    /* オーバーレイ効果のためのスタイル */
    .cyber-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(0, 0, 0, 0), rgba(0, 255, 255, 0.1), rgba(0, 0, 0, 0));
        z-index: 1;
        pointer-events: none;
    }
    
    /* 特殊なブランドカラー */
    .cyber-blue {
        color: #00bfff !important;
        text-shadow: 0 0 5px rgba(0, 191, 255, 0.5) !important;
    }
    
    .cyber-pink {
        color: #ff80c0 !important;
        text-shadow: 0 0 5px rgba(255, 128, 192, 0.5) !important;
    }
    
    .cyber-green {
        color: #80ff80 !important;
        text-shadow: 0 0 5px rgba(128, 255, 128, 0.5) !important;
    }
</style>
{% endblock %} 